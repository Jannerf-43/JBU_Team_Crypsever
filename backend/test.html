<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>μ•”νΈν™” μ„λ²„ ν…μ¤νΈ</title>
  </head>
  <body>
    <h2>π” νμΌ μ•”νΈν™” ν…μ¤νΈ</h2>

    <form id="form">
      <p>μ•”νΈν™”ν•  νμΌ: <input type="file" id="file" required /></p>
      <p>μ‚¬μ©μ μΈμ¦μ„(.pem): <input type="file" id="cert" required /></p>
      <button type="submit">μ•”νΈν™” μ”μ²­</button>
    </form>

    <pre id="result"></pre>

    <script>
      document.getElementById('form').onsubmit = async (e) => {
        e.preventDefault()

        const file = document.getElementById('file').files[0]
        const cert = document.getElementById('cert').files[0]

        const formData = new FormData()
        formData.append('file', file)
        formData.append('cert', cert)

        const res = await fetch('http://localhost:8000/encrypt/', {
          method: 'POST',
          body: formData,
        })

        const data = await res.json()
        document.getElementById('result').innerText = JSON.stringify(
          data,
          null,
          2
        )

        // λ‹¤μ΄λ΅λ“ URL μλ™ λ§ν¬ μƒμ„±
        if (data.download_url) {
          const a = document.createElement('a')
          a.href = `http://localhost:8000/download/${data.file_id}`
          a.innerText = 'π“¥μ•”νΈν™”λ νμΌ λ‹¤μ΄λ΅λ“'
          a.download = ''
          document.body.appendChild(a)
        }
      }
    </script>
  </body>
</html>
